<!-- -start results section -->
<div class="grid-x" ng-if="result" style="padding-top: 1rem;">
  <div class="cell large-1">
    <h3 id="model-results-results-header" class="main-category-header">Results</h3>
  </div>
  <div class="cell large-8 end">
    <hr>
  </div>
</div>

<div class="grid-x" ng-show="result && model.linearModel === 'random'" style="padding-top: 1rem;">
  <div class="cell">
    <p>
      <strong>Random effects standard deviation </strong> {{result.summaries.quantiles["sd.d"]["50%"]
      | number: 3}} ({{result.summaries.quantiles["sd.d"]["2.5%"] | number: 3}},
      {{result.summaries.quantiles["sd.d"]["97.5%"] | number: 3}})</p>
  </div>
</div>

<div class="grid-x" ng-if="result && model.modelType.type === 'node-split'">
  <div class="column">
    <table>
      <caption>Node splitting results</caption>
      <thead>
        <tr>
          <th> </th>
          <th>Median (95% CrI)</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <strong>Direct estimate </strong>
            <data-inline-help help-key="direct-estimate"></data-inline-help>
          </td>
          <td>{{::result.summaries.quantiles['d.direct']['50%'] | number: 3}} ({{::result.summaries.quantiles['d.direct']['2.5%']
            | number: 3}}, {{::result.summaries.quantiles['d.direct']['97.5%'] |
            number: 3}})
          </td>
        </tr>
        <tr>
          <td>
            <strong>Indirect estimate </strong>
            <data-inline-help help-key="indirect-estimate"></data-inline-help>
          </td>
          <td>{{::result.summaries.quantiles['d.indirect']['50%'] | number: 3}} ({{::result.summaries.quantiles['d.indirect']['2.5%']
            | number: 3}}, {{::result.summaries.quantiles['d.indirect']['97.5%']
            | number: 3}})</td>
        </tr>
        <tr>
          <td>
            <strong>Inconsistency factor</strong>
          </td>
          <td>{{::result.nodeSplit.diff.quantiles['50%'] | number: 3}} ({{::result.nodeSplit.diff.quantiles['2.5%']
            | number: 3}}, {{::result.nodeSplit.diff.quantiles['97.5%'] | number:
            3}})
          </td>
        </tr>
        <tr>
          <td>
            <strong>Inconsistency P-value</strong>
          </td>
          <td>{{::result.nodeSplit['incons.p'] | number: 3}}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<div ng-if="result && model.modelType.type === 'network' && scaleName !== 'risk ratio'">
  <div class="grid-x" ng-if="problem.entries.length">
    <div class="cell">
      <p>
        <Strong>Absolute treatment effects
          <data-inline-help help-key="absolute-effects"></data-inline-help>
        </Strong>
      </p>
      <p ng-if="!baselineDistribution">
        <em>No baseline distribution set.</em>
      </p>
    </div>
  </div>
  <div class="grid-x" ng-if="baselineDistribution">
    <div class="cell large-8">
      <table id="absolute-effects-table">
        <caption>Absolute effects table</caption>
        <thead>
          <th ng-repeat="treatment in problem.treatments">{{treatment.name}}</th>
        </thead>
        <tbody>
          <tr>
            <td ng-repeat="treatment in problem.treatments"> {{scales[treatment.name]['50%']| number: 3}} ({{scales[treatment.name]['2.5%']|
              number: 3}}, {{scales[treatment.name]['97.5%']| number: 3}})</td>
          </tr>
        </tbody>
      </table>
      <p>
        <strong>Baseline distribution
          <data-inline-help help-key="baseline-distribution"></data-inline-help>
        </strong>
        {{baselineDistribution | distributionToStringFilter}}
      </p>
    </div>
    <div class="cell large-4">
      <button class="button clipboard-button" data-clipboard-target="#absolute-effects-table">
        <i class="fa fa-clipboard"></i> Copy to clipboard
      </button>
    </div>
  </div>
  <div class="grid-x" ng-if="problem.entries.length">
    <div class="cell">
      <button class="button" ng-if="!editMode.disableEditing" ng-click="openBaselineDistributionModal()">Set Baseline Distribution</button>
    </div>
  </div>
</div>

<div ng-if="result && model.modelType.type !== 'node-split'">
  <div class="grid-x" style="padding-top: 1rem;">
    <div class="cell large-4">
      <p>
        <strong>Relative effects table
          <data-inline-help help-key="relative-effects"></data-inline-help>
        </strong>
      </p>
      <label ng-show="relativeEffectsTables.length > 1">
        Covariate level
        <select ng-options="relativeEffectsTable as relativeEffectsTable.level for relativeEffectsTable in relativeEffectsTables"
          ng-model="relativeEffectsTable"></select>
      </label>
    </div>
  </div>
  <div class="grid-x">
    <div class="cell large-8">
      <table id="relativeEffectsTableCopy">
        <caption>Comparison of the included interventions: {{::scaleName}} (95% CrI). Each
          cell gives the effect of the column-defining intervention relative to the
          row-defining intervention.
        </caption>
        <tr ng-repeat="relativeEffectsRow in relativeEffectsTable.data.rows">
          <td class="text-center" ng-class="{'empty-cell': $index <= $parent.$index-1}" ng-repeat="relativeEffectsCell in relativeEffectsRow.cells"
            ng-switch="relativeEffectsCell.cellType">
            <span ng-switch-when="effect">
              {{relativeEffectsCell.mean | number: 3}} ({{relativeEffectsCell.lowerBound | number:
              3}}, {{relativeEffectsCell.upperBound | number: 3}})
            </span>
            <span ng-switch-when="label" class="table-cell-label">
              {{relativeEffectsCell.label}}
            </span>
            <span ng-switch-when="empty"></span>
          </td>
        </tr>
      </table>
    </div>
    <div class="cell large-4">
      <button class="button clipboard-button" data-clipboard-target="#relativeEffectsTableCopy">
        <i class="fa fa-clipboard"></i> Copy to clipboard
      </button>
    </div>
  </div>
</div>

<relative-effect-plots model-promise="modelPromise" results-promise="resultsPromise"
  problem-promise="problemPromise"></relative-effect-plots>
<pairwise-forest-plots model-promise="modelPromise" results-promise="resultsPromise"
  problem-promise="problemPromise"></pairwise-forest-plots>

<div ng-if="result && model.modelType.type === 'pairwise'">
  <div class="grid-x">
    <div class="cell">
      <p>
        <strong>Study effect funnel plot </strong>
        <data-inline-help help-key="funnel-plot"></data-inline-help>
      </p>
    </div>
  </div>
  <funnel-plot results-promise="resultsPromise"></funnel-plot>
</div>

<div ng-if="result && model.modelType.type === 'network' && result.studyRelativeEffects">
  <div class="grid-x">
    <div class="cell">
      <p>
        <strong>Study effect funnel plot </strong>
        <data-inline-help help-key="funnel-plot"></data-inline-help>
      </p>
    </div>
  </div>
  <div class="grid-x" ng-if="comparisonAdjustedFunnelPlots.length > 0" ng-repeat="funnelPlot in comparisonAdjustedFunnelPlots">
    <div class="cell">
      <comparison-adjusted-funnel-plot plot-data="funnelPlot" problem-promise="problemPromise"
        results-promise="resultsPromise"></comparison-adjusted-funnel-plot>
    </div>
  </div>
  <div class="grid-x" ng-if="comparisonAdjustedFunnelPlots.length === 0">
    <div class="cell">
      No funnel plots have been created
    </div>
  </div>
</div>

<div ng-if="result && model.modelType.type === 'network' && !editMode.disableEditing">
  <div class="grid-x">
    <div class="cell">
      <button class="button" ng-click="openComparisonAdjustedModal()">Add comparison-adjusted funnel plot</button>
    </div>
  </div>
</div>

<node-split-density-plots model-promise="modelPromise" results-promise="resultsPromise"
  problem-promise="problemPromise"></node-split-density-plots>

<div ng-if="result && model.modelType.type !== 'node-split'">
  <div class="grid-x" style="padding-top: 1rem;">
    <div class="cell large-8">
      <div>
        <p>
          <strong>Rank probabilities </strong>
          <data-inline-help help-key="rank-probabilities"></data-inline-help>
        </p>
      </div>
      <div class="grid-x">
        <div class="cell large-6 small-8">
          <label ng-show="rankProbabilitiesByLevel.length > 1">
            Covariate level
            <select ng-options="rankProbabilities as rankProbabilities.level for rankProbabilities in rankProbabilitiesByLevel"
              ng-model="rankProbabilities"></select>
          </label>
        </div>
      </div>
      <table id="rankProbabilitiesTableCopy">
        <caption>Rank probabilities table</caption>
        <thead>
          <tr>
            <th></th>
            <th ng-repeat="rank in rankProbabilities.data">Rank {{::$index + 1}}</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="(treatment, rankValues) in rankProbabilities.data">
            <td>{{::treatment}}</td>
            <td ng-repeat="rank in rankValues track by $index">
              {{rank | number : 3}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="cell large-4">
      <button class="button clipboard-button" data-clipboard-target="#rankProbabilitiesTableCopy">
        <i class="fa fa-clipboard"></i> Copy to clipboard
      </button>
    </div>
  </div>

  <div class="grid-x" style="padding-top: 1rem;">
    <div class="cell">
      Rank probabilities plot
    </div>
  </div>
  <div class="grid-x">
    <div class="cell">
      <div class="addis-graph" style="width:450px; height:450px;" export file-name="'rankProbabilities'">
        <data-gemtc-rank-plot value="rankProbabilities.data" stacked="true"></data-gemtc-rank-plot>
      </div>
    </div>
  </div>
</div>
<!-- -end  results section -->